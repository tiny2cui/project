<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head id="Head"><title>
	czanyou - C++博客
</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta id="metaKeywords" name="keywords" content="C++,cppblog,vc,mfc,博客,C++ blog,C++博客" /><link type="text/css" rel="stylesheet" href="/css/common.css" /><link id="MainCss" type="text/css" rel="stylesheet" href="http://www.cppblog.com/Skins/MTGABlue/style.css" /><link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cppblog.com/czanyou/rss.aspx" /></head>
<body>
    <form name="Form1" method="post" action="67940.html，" id="Form1">
<div>
<input type="hidden" name="__VIEWSTATE" id="
__VIEWSTATE" value="" />
</div>

        

<div id="top">

<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cppblog.com/czanyou/">czanyou</a></h1>
<p id="tagline"></p>
</div>
<div id="rightmenu" style="display:none">

	
<h3>My Links</h3>
<ul>
			<li><a id="MyLinks1_HomeLink" href="http://www.cppblog.com/">C++博客</a></li>
			<li><a id="MyLinks1_MyHomeLink" href="http://www.cppblog.com/czanyou/">首页</a></li>
			<li><a id="MyLinks1_NewPostLink" href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?opt=1">新随笔</a></li>
			<li><a id="MyLinks1_ContactLink" accesskey="9" href="http://www.cppblog.com/czanyou/contact.aspx?id=1">联系</a></li>
			<li><a id="MyLinks1_Syndication" href="http://www.cppblog.com/czanyou/Rss.aspx">聚合</a> <a id="MyLinks1_XMLLink" href="http://www.cppblog.com/czanyou/Rss.aspx"><img src="http://www.cppblog.com/images/xml.gif" style="border-width:0px;" /></a>
			<li><a id="MyLinks1_Admin" href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx">管理</a></li>
</ul>
	
<h3>Blog Stats</h3>
	<ul>
		<li>Posts - 5
		<li>Stories - 0
		<li>Comments - 22
		<li>Trackbacks - 0
	</li>
</ul>
	
	
<h3>常用链接</h3>
<ul>
		<li><a id="SingleColumn1_ctl00_repeaterLinks_ctl01_lnkLinkItem" href="http://www.cppblog.com/czanyou/MyPosts.html">我的随笔</a></li>
	
		<li><a id="SingleColumn1_ctl00_repeaterLinks_ctl02_lnkLinkItem" href="http://www.cppblog.com/czanyou/MyComments.html">我的评论</a></li>
	
		<li><a id="SingleColumn1_ctl00_repeaterLinks_ctl03_lnkLinkItem" href="http://www.cppblog.com/czanyou/OtherPosts.html">我参与的随笔</a></li>
	</ul>
<H3>留言簿<span style="font-size:11px;font-weight:normal;">(6)</span></H3>
<ul>
	<li>
		<a id="SingleColumn1__2386992_lnkMessages" href="http://www.cppblog.com/czanyou/Contact.aspx?id=1">给我留言</a>
	<li>
		<a id="SingleColumn1__2386992_lnkPublicMsgView" href="http://www.cppblog.com/czanyou/default.aspx?opt=msg">查看公开留言</a>
	<li>
		<a id="SingleColumn1__2386992_lnkPrivateMsgView" href="http://www.cppblog.com/czanyou/admin/MyMessages.aspx">查看私人留言</a>
	</li>
</ul>

		<h3>随笔档案</h3>
		
				<ul>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl01_Link" href="http://www.cppblog.com/czanyou/archive/2011/09.html">2011年9月 (4)</a> </li>
			
				<li><a id="SingleColumn1_Categories_CatList_ctl00_LinkList_ctl02_Link" href="http://www.cppblog.com/czanyou/archive/2008/11.html">2008年11月 (1)</a> </li>
			
				</ul>
			
	

<script language="JavaScript">
function SearchGoogle(key,evt,site)
		{
			if(evt.keyCode==13 || evt.keyCode==0 || evt.type =='click')
			{
				key.focus();
				var keystr = encodeURIComponent(key.value);
				url = "http://www.google.com/search?q=";
				url = url+keystr;
				url += "&ie=UTF-8&oe=GB2312&hl=zh-CN&domains="+site+"&sitesearch="+site;
				window.location=url;
				return false;
			}
		}
</script>
<H3>搜索</H3>
<ul>
	<li>
		<li><input style="WIDTH: 130px" type="text" name="q" id="q" onkeydown="return SearchGoogle(document.getElementById('q'),event,'www.cppblog.com/czanyou')">&nbsp;<input onclick="SearchGoogle(document.getElementById('q'),event,'www.cppblog.com/czanyou')" type="button" value="搜索" name="sa">
	</li>
</ul>

<h3>最新评论
	<a id="SingleColumn1__30f4f53_RSSHyperlink1" href="http://www.cppblog.com/czanyou/CommentsRSS.aspx"><img src="/images/xml.gif" style="border-width:0px;" /></a></h3>
<div class="RecentComment">
	
			<ul>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__30f4f53_CommentList_ctl01_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2013/03/08/67940.html#198289">1. re: H.264 RTP payload 格式</a>
			</li>
			<li style="word-break:break-all">
				这篇牛！！！！<br>贼清楚啦~~~
			</li>
			<li style="text-align:right;margin-right:4px">
				--kaly_liu</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__30f4f53_CommentList_ctl02_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2013/02/25/67940.html#198064">2. re: H.264 RTP payload 格式</a>
			</li>
			<li style="word-break:break-all">
				没有看到source code，能share下吗？
			</li>
			<li style="text-align:right;margin-right:4px">
				--hiber</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__30f4f53_CommentList_ctl03_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2013/01/29/155423.html#197620">3. re: 如何在 iPhone 下面生成 H.264 TS 流实现  HTTP live streaming  开发记录 (1)</a>
			</li>
			<li style="word-break:break-all">
				0.0
			</li>
			<li style="text-align:right;margin-right:4px">
				--elel</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__30f4f53_CommentList_ctl04_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2012/08/09/155419.html#186717">4. re: 如何在 iPhone 下面用 ffmpeg 播放 H.264 流开发记录 (1)</a>
			</li>
			<li style="word-break:break-all">
				评论内容较长,点击标题查看
			</li>
			<li style="text-align:right;margin-right:4px">
				--hong</li>
		
			<li style="word-break:break-all">
				<a id="SingleColumn1__30f4f53_CommentList_ctl05_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2012/07/05/67940.html#181448">5. re: H.264 RTP payload 格式</a>
			</li>
			<li style="word-break:break-all">
				肯定是MIN啊<br>@sc<br>
			</li>
			<li style="text-align:right;margin-right:4px">
				--童爱玲</li>
		
			</ul>
		
</div>

<h3>阅读排行榜</h3>
<div class="RecentComment">
	
			<ul style="word-break:break-all">
		
			<li>
				<a id="SingleColumn1__181ba7d_TopList_ctl01_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2008/11/26/67940.aspx">1. H.264 RTP payload 格式(32419)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__181ba7d_TopList_ctl02_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155419.aspx">2. 如何在 iPhone 下面用 ffmpeg 播放 H.264 流开发记录 (1)(2962)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__181ba7d_TopList_ctl03_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155421.aspx">3. 如何在 iPhone 下面用 ffmpeg 解码 H.264 流 (2) (2328)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__181ba7d_TopList_ctl04_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155422.aspx">4. 如何在 iPhone 下面用 OpenGL ES 显示视频开发记录 (3)(847)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__181ba7d_TopList_ctl05_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155423.aspx">5. 如何在 iPhone 下面生成 H.264 TS 流实现  HTTP live streaming  开发记录 (1)(723)</a>
			</li>
		
			</ul>
		
</div>

<h3>评论排行榜</h3>
<div class="RecentComment">
	
			<ul style="word-break:break-all">
		
			<li>
				<a id="SingleColumn1__12d0f90_TopList_ctl01_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2008/11/26/67940.aspx">1. H.264 RTP payload 格式(17)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__12d0f90_TopList_ctl02_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155421.aspx">2. 如何在 iPhone 下面用 ffmpeg 解码 H.264 流 (2) (2)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__12d0f90_TopList_ctl03_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155419.aspx">3. 如何在 iPhone 下面用 ffmpeg 播放 H.264 流开发记录 (1)(2)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__12d0f90_TopList_ctl04_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155423.aspx">4. 如何在 iPhone 下面生成 H.264 TS 流实现  HTTP live streaming  开发记录 (1)(1)</a>
			</li>
		
			<li>
				<a id="SingleColumn1__12d0f90_TopList_ctl05_Hyperlink1" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155422.aspx">5. 如何在 iPhone 下面用 OpenGL ES 显示视频开发记录 (3)(0)</a>
			</li>
		
			</ul>
		
</div>


</div>

<div id="main">
	
					
		
<p class="date">
	2011年9月9日		  
	<a id="_41b6c13e8876_HomePageDays_DaysList_ctl00_DayItem_ImageLink" Title="Day Archive" href="http://www.cppblog.com/czanyou/archive/2011/09/09.html" style="display:inline-block;border-width:0px;height:15px;width:12px;">#</a>
</p>


		<div class="post">
			<h2><a id="_41b6c13e8876_HomePageDays_DaysList_ctl00_DayItem_DayList_ctl00_TitleUrl" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155423.html">如何在 iPhone 下面生成 H.264 TS 流实现  HTTP live streaming  开发记录 (1)</a></h2>
			
			<br />待整理...
			
			<p class="postfoot">		
				posted @ <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155423.html" Title = "permalink">2011-09-09 10:40</a> 暗黑长老 阅读(723) | <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155423.html#FeedBack" Title = "comments, pingbacks, trackbacks">评论 (1)</a> |&nbsp;<a href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?postid=155423">编辑</a>&nbsp;<a href="http://www.cppblog.com/czanyou/AddToFavorite.aspx?id=155423">收藏</a>
			</p>
		</div>
	
		<div class="post">
			<h2><a id="_41b6c13e8876_HomePageDays_DaysList_ctl00_DayItem_DayList_ctl01_TitleUrl" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155422.html">如何在 iPhone 下面用 OpenGL ES 显示视频开发记录 (3)</a></h2>
			
			<br />通过 OpenGL ES 显示视频的方法:<br />(注意, 这里需要用到 &lt;&lt;iPhone 开发基础教程&gt;&gt; 12 章中的示例代码中的两个类:&nbsp;OpenGLES2DView,&nbsp;Texture2D, 具体请参考相关的资料)<br /><br />由于时间关系, 记录比较简单 (可通过 anyou@qq.com 联系我)&nbsp;<br /><br /><br /><div style="background-color:#eeeeee;font-size:13px;border:1px solid #CCCCCC;padding-right: 5px;padding-bottom: 4px;padding-left: 4px;padding-top: 4px;width: 98%;word-break:break-all"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080; ">&nbsp;1</span>&nbsp;<span style="color: #000000; ">-</span><span style="color: #000000; ">&nbsp;(</span><span style="color: #0000FF; ">void</span><span style="color: #000000; ">)&nbsp;draw&nbsp;{<br /></span><span style="color: #008080; ">&nbsp;2</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">&nbsp;3</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(fBitmapBuffer&nbsp;</span><span style="color: #000000; ">==</span><span style="color: #000000; ">&nbsp;nil)&nbsp;{<br /></span><span style="color: #008080; ">&nbsp;4</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">&nbsp;5</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">&nbsp;6</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">&nbsp;7</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;glLoadIdentity();<br /></span><span style="color: #008080; ">&nbsp;8</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;glClearColor(</span><span style="color: #000000; ">0.0f</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">0.0f</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">0.0f</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">1.0f</span><span style="color: #000000; ">);<br /></span><span style="color: #008080; ">&nbsp;9</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;glClear(GL_COLOR_BUFFER_BIT);<br /></span><span style="color: #008080; ">10</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">11</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(self.sprite)&nbsp;{<br /></span><span style="color: #008080; ">12</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[self.sprite&nbsp;release];<br /></span><span style="color: #008080; ">13</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sprite&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;nil;<br /></span><span style="color: #008080; ">14</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">15</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">16</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">char</span><span style="color: #000000; ">*</span><span style="color: #000000; ">&nbsp;bitmap&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;[self&nbsp;getBitmapBuffer];<br /></span><span style="color: #008080; ">17</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">18</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(self.sprite&nbsp;</span><span style="color: #000000; ">==</span><span style="color: #000000; ">&nbsp;nil)&nbsp;{<br /></span><span style="color: #008080; ">19</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CGSize&nbsp;size&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;CGSizeMake(self.width,&nbsp;self.height);<br /></span><span style="color: #008080; ">20</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;self.sprite&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;[[Texture2D&nbsp;alloc]&nbsp;initWithData:bitmap&nbsp;<br /></span><span style="color: #008080; ">21</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixelFormat:kTexture2DPixelFormat_RGBA8888&nbsp;<br /></span><span style="color: #008080; ">22</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixelsWide:</span><span style="color: #000000; ">512</span><span style="color: #000000; ">&nbsp;pixelsHigh:</span><span style="color: #000000; ">512</span><span style="color: #000000; ">&nbsp;contentSize:size];<br /></span><span style="color: #008080; ">23</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">24</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">25</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(self.sprite)&nbsp;{<br /></span><span style="color: #008080; ">26</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;glEnable(GL_TEXTURE_2D);<br /></span><span style="color: #008080; ">27</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;width&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;self.bounds.size.width;<br /></span><span style="color: #008080; ">28</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">int&nbsp;height&nbsp;=&nbsp;self.bounds.size.height;</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">29</span>&nbsp;<span style="color: #008000; "></span><span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(width&nbsp;</span><span style="color: #000000; ">&lt;=</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">320</span><span style="color: #000000; ">)&nbsp;{<br /></span><span style="color: #008080; ">30</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">[self.sprite&nbsp;drawAtPoint:CGPointMake(170,&nbsp;224)];</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">31</span>&nbsp;<span style="color: #008000; "></span><span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[self.sprite&nbsp;drawInRect:CGRectMake(</span><span style="color: #000000; ">0</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">320</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">240</span><span style="color: #000000; ">)];<br /></span><span style="color: #008080; ">32</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">33</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;</span><span style="color: #0000FF; ">else</span><span style="color: #000000; ">&nbsp;{<br /></span><span style="color: #008080; ">34</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[self.sprite&nbsp;drawInRect:CGRectMake(</span><span style="color: #000000; ">0</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">320</span><span style="color: #000000; ">,&nbsp;</span><span style="color: #000000; ">240</span><span style="color: #000000; ">)];<br /></span><span style="color: #008080; ">35</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">36</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">37</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">38</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">39</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;glBindRenderbufferOES(GL_RENDERBUFFER_OES,&nbsp;viewRenderbuffer);<br /></span><span style="color: #008080; ">40</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;[context&nbsp;presentRenderbuffer:GL_RENDERBUFFER_OES];<br /></span><span style="color: #008080; ">41</span>&nbsp;<span style="color: #000000; ">}</span></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
			
			<p class="postfoot">		
				posted @ <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155422.html" Title = "permalink">2011-09-09 10:38</a> 暗黑长老 阅读(847) | <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155422.html#FeedBack" Title = "comments, pingbacks, trackbacks">评论 (0)</a> |&nbsp;<a href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?postid=155422">编辑</a>&nbsp;<a href="http://www.cppblog.com/czanyou/AddToFavorite.aspx?id=155422">收藏</a>
			</p>
		</div>
	
		<div class="post">
			<h2><a id="_41b6c13e8876_HomePageDays_DaysList_ctl00_DayItem_DayList_ctl02_TitleUrl" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155421.html">如何在 iPhone 下面用 ffmpeg 解码 H.264 流 (2) </a></h2>
			
			&nbsp;&nbsp;&nbsp;&nbsp; 摘要: Code highlighting produced by Actipro CodeHighlighter (freeware)http://www.CodeHighlighter.com/-->&nbsp; 下面是如果解码以及将 &nbsp;YV12 数据转换成&nbsp;32 位 ARGB 数据的代码&nbsp; 1&nbsp;&nbsp;&nbsp;2&nbsp;#include&nbsp;...&nbsp;&nbsp;<a href='http://www.cppblog.com/czanyou/archive/2011/09/09/155421.html'>阅读全文</a>
			
			<p class="postfoot">		
				posted @ <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155421.html" Title = "permalink">2011-09-09 10:31</a> 暗黑长老 阅读(2328) | <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155421.html#FeedBack" Title = "comments, pingbacks, trackbacks">评论 (2)</a> |&nbsp;<a href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?postid=155421">编辑</a>&nbsp;<a href="http://www.cppblog.com/czanyou/AddToFavorite.aspx?id=155421">收藏</a>
			</p>
		</div>
	
		<div class="post">
			<h2><a id="_41b6c13e8876_HomePageDays_DaysList_ctl00_DayItem_DayList_ctl03_TitleUrl" href="http://www.cppblog.com/czanyou/archive/2011/09/09/155419.html">如何在 iPhone 下面用 ffmpeg 播放 H.264 流开发记录 (1)</a></h2>
			
			<div><div><div><div>下载最新的 ffmpeg, 我下的是 0.8.2<br /></div><div></div><div>下载最新的 gas-preprocessor 脚本 (用来在 MAC OS X 下编译汇编代码的):</div><div>https://github.com/yuvi/gas-preprocessor</div><div>请将 gas-preprocessor.pl 脚本安装在 /usr/sbin 或者其他执行文件目录下, 并添加执行权限<br /></div><div></div><div>分别使用下面的配置进行编译:</div><div></div><div>IOS4.3 armv7 版本 (iPhone 3Gs, iPhone4):</div><div>./configure --disable-doc --disable-ffmpeg --disable-ffplay --disable-ffserver --disable-avdevice --disable-swscale --disable-avfilter --disable-avformat --disable-debug --disable-encoders --enable-cross-compile --disable-decoders --disable-armv5te --enable-decoder=h264 --enable-pic --arch=arm --target-os=darwin --cc=/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc --as='gas-preprocessor/gas-preprocessor.pl /Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' --sysroot=/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.3.sdk --cpu=cortex-a8 --extra-cflags='-arch armv7' --extra-ldflags='-arch armv7 -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.3.sdk'<br /></div><div></div><div>IOS4.3 armv6 版本 (iPhone 3G):</div><div>./configure --disable-doc --disable-ffmpeg --disable-ffplay --disable-ffserver --disable-avdevice --disable-swscale --disable-avfilter --disable-avformat --disable-debug --disable-encoders --enable-cross-compile --disable-decoders --disable-armv5te --enable-decoder=h264 --enable-pic --arch=arm --target-os=darwin --cc=/Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc --as='gas-preprocessor/gas-preprocessor.pl /Developer/Platforms/iPhoneOS.platform/Developer/usr/bin/gcc' --sysroot=/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.3.sdk --cpu=arm1176jzf-s --extra-cflags='-arch armv6' --extra-ldflags='-arch armv6 -isysroot /Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS4.3.sdk'<br /></div><div></div><div>IOS4.3 i386 版本 (用于模拟器):</div><div>./configure --disable-doc --disable-ffmpeg --disable-ffplay --disable-ffserver --disable-avdevice --disable-swscale --disable-avfilter --disable-avformat --disable-debug --disable-encoders --enable-cross-compile --disable-decoders --disable-armv5te --enable-decoder=h264 --enable-pic --cc=/Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc --as='gas-preprocessor/gas-preprocessor.pl /Developer/Platforms/iPhoneSimulator.platform/Developer/usr/bin/gcc' --extra-ldflags=-L/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator4.3.sdk/usr/lib/system --sysroot=/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs/iPhoneSimulator4.3.sdk --target-os=darwin --arch=i386 --cpu=i386 --extra-cflags='-arch i386' --extra-ldflags='-arch i386'<br /></div><div></div><div>将上述分别编译出来的库, 打包成一个统一的版本的方法:</div><div>lipo -create -arch armv6 armv6/libavcodec.a -arch armv7 armv7/libavcodec.a -arch i386 i386/libavcodec.a -output libavcodec.a</div><div>lipo -create -arch armv6 armv6/libavutil.a -arch armv7 armv7/libavutil.a -arch i386 i386/libavutil.a -output libavutil.a<br /></div><div></div><div>添加 libavcodec.a, libavutil.a, libavcodec/avcodec.h, 以及 libavutil 下所有头文件到工程中 (请注意路径).<br /></div><div></div><div>解码的方法 (代码片断如下, 完整代码请参考相关附件):</div><div></div><div><div style="background-color:#eeeeee;font-size:13px;border:1px solid #CCCCCC;padding-right: 5px;padding-bottom: 4px;padding-left: 4px;padding-top: 4px;width: 98%;word-break:break-all"><!--<br /><br />Code highlighting produced by Actipro CodeHighlighter (freeware)<br />http://www.CodeHighlighter.com/<br /><br />--><span style="color: #008080; ">&nbsp;1</span>&nbsp;<span style="color: #0000FF; ">struct</span><span style="color: #000000; ">&nbsp;AVCodec&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">fCodec&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;NULL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">&nbsp;Codec</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">&nbsp;2</span>&nbsp;<span style="color: #008000; "></span><span style="color: #0000FF; ">struct</span><span style="color: #000000; ">&nbsp;AVCodecContext&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">fCodecContext&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;NULL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">&nbsp;Codec&nbsp;Context</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">&nbsp;3</span>&nbsp;<span style="color: #008000; "></span><span style="color: #0000FF; ">struct</span><span style="color: #000000; ">&nbsp;AVFrame&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">fVideoFrame&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;NULL;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">&nbsp;Frame&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">&nbsp;4</span>&nbsp;<span style="color: #008000; "></span><span style="color: #000000; "><br /></span><span style="color: #008080; ">&nbsp;5</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;fDisplayWidth&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">&nbsp;6</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;fDisplayHeight&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">&nbsp;7</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">&nbsp;8</span>&nbsp;<span style="color: #000000; "><img src="http://www.cppblog.com/Images/dot.gif" alt="" />&nbsp;<img src="http://www.cppblog.com/Images/dot.gif" alt="" /><br /></span><span style="color: #008080; ">&nbsp;9</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">10</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;avcodec_decode_video(AVCodecContext&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">avctx,&nbsp;AVFrame&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">picture,<br /></span><span style="color: #008080; ">11</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">got_picture_ptr,<br /></span><span style="color: #008080; ">12</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">const</span><span style="color: #000000; ">&nbsp;uint8_t&nbsp;</span><span style="color: #000000; ">*</span><span style="color: #000000; ">buf,&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;buf_size)<br /></span><span style="color: #008080; ">13</span>&nbsp;<span style="color: #000000; ">{<br /></span><span style="color: #008080; ">14</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;AVPacket&nbsp;avpkt;<br /></span><span style="color: #008080; ">15</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;av_init_packet(</span><span style="color: #000000; ">&amp;</span><span style="color: #000000; ">avpkt);<br /></span><span style="color: #008080; ">16</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avpkt.data&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;buf;<br /></span><span style="color: #008080; ">17</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avpkt.size&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;buf_size;<br /></span><span style="color: #008080; ">18</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #008000; ">//</span><span style="color: #008000; ">&nbsp;HACK&nbsp;for&nbsp;CorePNG&nbsp;to&nbsp;decode&nbsp;as&nbsp;normal&nbsp;PNG&nbsp;by&nbsp;default</span><span style="color: #008000; "><br /></span><span style="color: #008080; ">19</span>&nbsp;<span style="color: #008000; "></span><span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avpkt.flags&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;AV_PKT_FLAG_KEY;<br /></span><span style="color: #008080; ">20</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;avcodec_decode_video2(avctx,&nbsp;picture,&nbsp;got_picture_ptr,&nbsp;</span><span style="color: #000000; ">&amp;</span><span style="color: #000000; ">avpkt);<br /></span><span style="color: #008080; ">21</span>&nbsp;<span style="color: #000000; ">}<br /></span><span style="color: #008080; ">22</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">23</span>&nbsp;<span style="color: #000000; "><img src="http://www.cppblog.com/Images/dot.gif" alt="" />&nbsp;<img src="http://www.cppblog.com/Images/dot.gif" alt="" /><br /></span><span style="color: #008080; ">24</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">25</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;avc_decode_init(</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;width,&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;height)<br /></span><span style="color: #008080; ">26</span>&nbsp;<span style="color: #000000; ">{<br /></span><span style="color: #008080; ">27</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(fCodecContext&nbsp;</span><span style="color: #000000; ">!=</span><span style="color: #000000; ">&nbsp;NULL)&nbsp;{<br /></span><span style="color: #008080; ">28</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">29</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">30</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avcodec_init();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">31</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avcodec_register_all();<br /></span><span style="color: #008080; ">32</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;fCodec&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;avcodec_find_decoder(CODEC_ID_H264);<br /></span><span style="color: #008080; ">33</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">34</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;fDisplayWidth&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;width;<br /></span><span style="color: #008080; ">35</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;fDisplayHeight&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;height;<br /></span><span style="color: #008080; ">36</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">37</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;CreateYUVTable();&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">38</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">39</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;fCodecContext&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;avcodec_alloc_context();&nbsp;<br /></span><span style="color: #008080; ">40</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;avcodec_open(fCodecContext,&nbsp;fCodec);&nbsp;<br /></span><span style="color: #008080; ">41</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;fVideoFrame&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;avcodec_alloc_frame();<br /></span><span style="color: #008080; ">42</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">43</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">1</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">44</span>&nbsp;<span style="color: #000000; ">}<br /></span><span style="color: #008080; ">45</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">46</span>&nbsp;<span style="color: #000000; "><img src="http://www.cppblog.com/Images/dot.gif" alt="" />&nbsp;<img src="http://www.cppblog.com/Images/dot.gif" alt="" /><br /></span><span style="color: #008080; ">47</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">48</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;avc_decode_release()<br /></span><span style="color: #008080; ">49</span>&nbsp;<span style="color: #000000; ">{<br /></span><span style="color: #008080; ">50</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(fCodecContext)&nbsp;{<br /></span><span style="color: #008080; ">51</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;avcodec_close(fCodecContext);<br /></span><span style="color: #008080; ">52</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free(fCodecContext</span><span style="color: #000000; ">-&gt;</span><span style="color: #000000; ">priv_data);<br /></span><span style="color: #008080; ">53</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free(fCodecContext);<br /></span><span style="color: #008080; ">54</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fCodecContext&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;NULL;<br /></span><span style="color: #008080; ">55</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">56</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">57</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(fVideoFrame)&nbsp;{<br /></span><span style="color: #008080; ">58</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;free(fVideoFrame);<br /></span><span style="color: #008080; ">59</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fVideoFrame&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;NULL;<br /></span><span style="color: #008080; ">60</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">61</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">62</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;DeleteYUVTable();<br /></span><span style="color: #008080; ">63</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">1</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">64</span>&nbsp;<span style="color: #000000; ">}<br /></span><span style="color: #008080; ">65</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">66</span>&nbsp;<span style="color: #000000; "><img src="http://www.cppblog.com/Images/dot.gif" alt="" />&nbsp;<img src="http://www.cppblog.com/Images/dot.gif" alt="" /><br /></span><span style="color: #008080; ">67</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">68</span>&nbsp;<span style="color: #000000; "></span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;avc_decode(</span><span style="color: #0000FF; ">char</span><span style="color: #000000; ">*</span><span style="color: #000000; ">&nbsp;buf,&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;nalLen,&nbsp;</span><span style="color: #0000FF; ">char</span><span style="color: #000000; ">*</span><span style="color: #000000; ">&nbsp;</span><span style="color: #0000FF; ">out</span><span style="color: #000000; ">)<br /></span><span style="color: #008080; ">69</span>&nbsp;<span style="color: #000000; ">{<br /></span><span style="color: #008080; ">70</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;byte_t</span><span style="color: #000000; ">*</span><span style="color: #000000; ">&nbsp;data&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;(byte_t</span><span style="color: #000000; ">*</span><span style="color: #000000; ">)buf;<br /></span><span style="color: #008080; ">71</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;frameSize&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">;<br /></span><span style="color: #008080; ">72</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">73</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;ret&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;avcodec_decode_video(fCodecContext,&nbsp;fVideoFrame,&nbsp;</span><span style="color: #000000; ">&amp;</span><span style="color: #000000; ">frameSize,&nbsp;data,&nbsp;nalLen);&nbsp;<br /></span><span style="color: #008080; ">74</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">if</span><span style="color: #000000; ">&nbsp;(ret&nbsp;</span><span style="color: #000000; ">&lt;=</span><span style="color: #000000; ">&nbsp;</span><span style="color: #000000; ">0</span><span style="color: #000000; ">)&nbsp;{<br /></span><span style="color: #008080; ">75</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;ret;<br /></span><span style="color: #008080; ">76</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;}<br /></span><span style="color: #008080; ">77</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">78</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;width&nbsp;&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;fCodecContext</span><span style="color: #000000; ">-&gt;</span><span style="color: #000000; ">width;<br /></span><span style="color: #008080; ">79</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">int</span><span style="color: #000000; ">&nbsp;height&nbsp;</span><span style="color: #000000; ">=</span><span style="color: #000000; ">&nbsp;fCodecContext</span><span style="color: #000000; ">-&gt;</span><span style="color: #000000; ">height;<br /></span><span style="color: #008080; ">80</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;DisplayYUV_32((uint32_t</span><span style="color: #000000; ">*</span><span style="color: #000000; ">)</span><span style="color: #0000FF; ">out</span><span style="color: #000000; ">,&nbsp;width,&nbsp;height,&nbsp;fDisplayWidth);<br /></span><span style="color: #008080; ">81</span>&nbsp;<span style="color: #000000; ">&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000FF; ">return</span><span style="color: #000000; ">&nbsp;ret;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span style="color: #008080; ">82</span>&nbsp;<span style="color: #000000; ">}<br /></span><span style="color: #008080; ">83</span>&nbsp;<span style="color: #000000; "><br /></span><span style="color: #008080; ">84</span>&nbsp;<span style="color: #000000; "><img src="http://www.cppblog.com/Images/dot.gif" alt="" />&nbsp;<img src="http://www.cppblog.com/Images/dot.gif" alt="" /></span></div></div><div></div></div></div></div>
			
			<p class="postfoot">		
				posted @ <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155419.html" Title = "permalink">2011-09-09 10:23</a> 暗黑长老 阅读(2962) | <a href="http://www.cppblog.com/czanyou/archive/2011/09/09/155419.html#FeedBack" Title = "comments, pingbacks, trackbacks">评论 (2)</a> |&nbsp;<a href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?postid=155419">编辑</a>&nbsp;<a href="http://www.cppblog.com/czanyou/AddToFavorite.aspx?id=155419">收藏</a>
			</p>
		</div>
	

	
		
<p class="date">
	2008年11月26日		  
	<a id="_41b6c13e8876_HomePageDays_DaysList_ctl01_DayItem_ImageLink" Title="Day Archive" href="http://www.cppblog.com/czanyou/archive/2008/11/26.html" style="display:inline-block;border-width:0px;height:15px;width:12px;">#</a>
</p>


		<div class="post">
			<h2><a id="_41b6c13e8876_HomePageDays_DaysList_ctl01_DayItem_DayList_ctl00_TitleUrl" href="http://www.cppblog.com/czanyou/archive/2008/11/26/67940.html">H.264 RTP payload 格式</a></h2>
			
			<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt"><br>H.264 视频 RTP 负载格式</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">1. 网络抽象层单元类型 (NALU)</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">NALU 头由一个字节组成, 它的语法如下:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |0|1|2|3|4|5|6|7|<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |F|NRI|&nbsp; Type&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">F: 1 个比特.<br>&nbsp; forbidden_zero_bit. 在 H.264 规范中规定了这一位必须为 0.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">NRI: 2 个比特.<br>&nbsp; nal_ref_idc. 取 00 ~ 11, 似乎指示这个 NALU 的重要性, 如 00 的 NALU 解码器可以丢弃它而不影响图像的回放. 不过一般情况下不太关心</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">这个属性.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">Type: 5 个比特.<br>&nbsp; nal_unit_type. 这个 NALU 单元的类型. 简述如下:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp; 没有定义<br>&nbsp; 1-23&nbsp; NAL单元&nbsp; 单个 NAL 单元包.<br>&nbsp; 24&nbsp;&nbsp;&nbsp; STAP-A&nbsp;&nbsp; 单一时间的组合包<br>&nbsp; 25&nbsp;&nbsp;&nbsp; STAP-B&nbsp;&nbsp; 单一时间的组合包<br>&nbsp; 26&nbsp;&nbsp;&nbsp; MTAP16&nbsp;&nbsp; 多个时间的组合包<br>&nbsp; 27&nbsp;&nbsp;&nbsp; MTAP24&nbsp;&nbsp; 多个时间的组合包<br>&nbsp; 28&nbsp;&nbsp;&nbsp; FU-A&nbsp;&nbsp;&nbsp;&nbsp; 分片的单元<br>&nbsp; 29&nbsp;&nbsp;&nbsp; FU-B&nbsp;&nbsp;&nbsp;&nbsp; 分片的单元<br>&nbsp; 30-31 没有定义</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">2. 打包模式</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 下面是 RFC 3550 中规定的 RTP 头的结构.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |V=2|P|X|&nbsp; CC&nbsp;&nbsp; |M|&nbsp;&nbsp;&nbsp;&nbsp; PT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sequence number&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; timestamp&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; synchronization source (SSRC) identifier&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; contributing source (CSRC) identifiers&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ....&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 负载类型 Payload type (PT): 7 bits<br>&nbsp; 序列号 Sequence number (SN): 16 bits<br>&nbsp; 时间戳 Timestamp: 32 bits<br>&nbsp; <br>&nbsp; H.264 Payload 格式定义了三种不同的基本的负载(Payload)结构. 接收端可能通过 RTP Payload <br>&nbsp; 的第一个字节来识别它们. 这一个字节类似 NALU 头的格式, 而这个头结构的 NAL 单元类型字段<br>&nbsp; 则指出了代表的是哪一种结构, </p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 这个字节的结构如下, 可以看出它和 H.264 的 NALU 头结构是一样的.<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |0|1|2|3|4|5|6|7|<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |F|NRI|&nbsp; Type&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+<br>&nbsp; 字段 Type: 这个 RTP payload 中 NAL 单元的类型. 这个字段和 H.264 中类型字段的区别是, 当 type<br>&nbsp; 的值为 24 ~ 31 表示这是一个特别格式的 NAL 单元, 而 H.264 中, 只取 1~23 是有效的值.<br>&nbsp;&nbsp; <br>&nbsp; 24&nbsp;&nbsp;&nbsp; STAP-A&nbsp;&nbsp; 单一时间的组合包<br>&nbsp; 25 &nbsp;&nbsp; STAP-B&nbsp;&nbsp; 单一时间的组合包<br>&nbsp; 26&nbsp;&nbsp;&nbsp; MTAP16&nbsp;&nbsp; 多个时间的组合包<br>&nbsp; 27&nbsp;&nbsp;&nbsp; MTAP24&nbsp;&nbsp; 多个时间的组合包<br>&nbsp; 28&nbsp;&nbsp;&nbsp; FU-A&nbsp;&nbsp;&nbsp;&nbsp; 分片的单元<br>&nbsp; 29&nbsp;&nbsp;&nbsp; FU-B&nbsp;&nbsp;&nbsp;&nbsp; 分片的单元<br>&nbsp; 30-31 没有定义</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 可能的结构类型分别有:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 1. 单一 NAL 单元模式<br>&nbsp;&nbsp;&nbsp;&nbsp; 即一个 RTP 包仅由一个完整的 NALU 组成. 这种情况下 RTP NAL 头类型字段和原始的 H.264的<br>&nbsp; NALU 头类型字段是一样的.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 2. 组合封包模式<br>&nbsp;&nbsp;&nbsp; 即可能是由多个 NAL 单元组成一个 RTP 包. 分别有4种组合方式: STAP-A, STAP-B, MTAP16, MTAP24.<br>&nbsp; 那么这里的类型值分别是 24, 25, 26 以及 27.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 3. 分片封包模式<br>&nbsp;&nbsp;&nbsp; 用于把一个 NALU 单元封装成多个 RTP 包. 存在两种类型 FU-A 和 FU-B. 类型值分别是 28 和 29.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">2.1 单一 NAL 单元模式</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 对于 NALU 的长度小于 MTU 大小的包, 一般采用单一 NAL 单元模式.<br>&nbsp; 对于一个原始的 H.264 NALU 单元常由 [Start Code] [NALU Header] [NALU Payload] 三部分组成, 其中 Start Code 用于标示这是一个 </p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">NALU 单元的开始, 必须是 "00 00 00 01" 或 "00 00 01", NALU 头仅一个字节, 其后都是 NALU 单元内容.<br>&nbsp; 打包时去除 "00 00 01" 或 "00 00 00 01" 的开始码, 把其他数据封包的 RTP 包即可.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |F|NRI|&nbsp; type&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bytes 2..n of a Single NAL unit&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :...OPTIONAL RTP padding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt"><br>&nbsp; 如有一个 H.264 的 NALU 是这样的:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; [00 00 00 01 67 42 A0 1E 23 56 0E 2F ... ]</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 这是一个序列参数集 NAL 单元. [00 00 00 01] 是四个字节的开始码, 67 是 NALU 头, 42 开始的数据是 NALU 内容.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 封装成 RTP 包将如下:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; [ RTP Header ] [ 67 42 A0 1E 23 56 0E 2F ]</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 即只要去掉 4 个字节的开始码就可以了.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt"><br>2.2 组合封包模式</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 其次, 当 NALU 的长度特别小时, 可以把几个 NALU 单元封在一个 RTP 包中.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; RTP Header&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |STAP-A NAL HDR |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NALU 1 Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | NALU 1 HDR&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NALU 1 Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | NALU 2 Size&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | NALU 2 HDR&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; NALU 2 Data&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :...OPTIONAL RTP padding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt"><br>2.3 Fragmentation Units (FUs).</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 而当 NALU 的长度超过 MTU 时, 就必须对 NALU 单元进行分片封包. 也称为 Fragmentation Units (FUs).<br>&nbsp; <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | FU indicator&nbsp; |&nbsp;&nbsp; FU header&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; FU payload&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; :...OPTIONAL RTP padding&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Figure 14.&nbsp; RTP payload format for FU-A</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp; The FU indicator octet has the following format:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |0|1|2|3|4|5|6|7|<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |F|NRI|&nbsp; Type&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp; The FU header has the following format:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |0|1|2|3|4|5|6|7|<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-+-+-+-+-+-+-+-+<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |S|E|R|&nbsp; Type&nbsp;&nbsp; |<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +---------------+</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt"><br>3. SDP 参数</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 下面描述了如何在 SDP 中表示一个 H.264 流:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; . "m=" 行中的媒体名必须是 "video"<br>&nbsp; . "a=rtpmap" 行中的编码名称必须是 "H264".<br>&nbsp; . "a=rtpmap" 行中的时钟频率必须是 90000.<br>&nbsp; . 其他参数都包括在 "a=fmtp" 行中.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 如:</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; m=video 49170 RTP/AVP 98<br>&nbsp; a=rtpmap:98 H264/90000<br>&nbsp; a=fmtp:98 profile-level-id=42A01E; sprop-parameter-sets=Z0IACpZTBYmI,aMljiA==</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; 下面介绍一些常用的参数.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">3.1 packetization-mode:<br>&nbsp; 表示支持的封包模式. <br>&nbsp; 当 packetization-mode 的值为 0 时或不存在时, 必须使用单一 NALU 单元模式.<br>&nbsp; 当 packetization-mode 的值为 1 时必须使用非交错(non-interleaved)封包模式.<br>&nbsp; 当 packetization-mode 的值为 2 时必须使用交错(interleaved)封包模式.<br>&nbsp; 这个参数不可以取其他的值.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">3.2 sprop-parameter-sets:<br>&nbsp; 这个参数可以用于传输 H.264 的序列参数集和图像参数 NAL 单元. 这个参数的值采用 Base64 进行编码. 不同的参数集间用","号隔开.<br>&nbsp; <br>3.3 profile-level-id:<br>&nbsp; 这个参数用于指示 H.264 流的 profile 类型和级别. 由 Base16(十六进制) 表示的 3 个字节. 第一个字节表示 H.264 的 Profile 类型, 第</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">三个字节表示 H.264 的 Profile 级别:<br>&nbsp; <br>3.4 max-mbps:<br>&nbsp; 这个参数的值是一个整型, 指出了每一秒最大的宏块处理速度.</p>
<p style="FONT-FAMILY: courier new; FONT-SIZE: 10pt">&nbsp; <br></p>

			
			<p class="postfoot">		
				posted @ <a href="http://www.cppblog.com/czanyou/archive/2008/11/26/67940.html" Title = "permalink">2008-11-26 23:39</a> 暗黑长老 阅读(32419) | <a href="http://www.cppblog.com/czanyou/archive/2008/11/26/67940.html#FeedBack" Title = "comments, pingbacks, trackbacks">评论 (17)</a> |&nbsp;<a href="http://www.cppblog.com/czanyou/admin/EditPosts.aspx?postid=67940">编辑</a>&nbsp;<a href="http://www.cppblog.com/czanyou/AddToFavorite.aspx?id=67940">收藏</a>
			</p>
		</div>
	

	
<div style="text-align:right;margin-right:10px;"><a href="http://www.cppblog.com/czanyou/default.html?OnlyTitle=1">仅列出标题</a>&nbsp;&nbsp;</div>

				
</div>


<p id="footer">
	Powered by: 
	<br />
	
	<a id="Footer1_Hyperlink3" NAME="Hyperlink1" href="http://www.cppblog.com/" style="font-family:Verdana;font-size:12px;">C++博客</a>
	<br />
	Copyright &copy; 暗黑长老
</p>    
    </form>
	<script type="text/javascript" src="/script/ShowHidden.js"></script>   
	<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-476124-5']);
	  _gaq.push(['_trackPageview']);

	  (function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>
</body>
</html>
