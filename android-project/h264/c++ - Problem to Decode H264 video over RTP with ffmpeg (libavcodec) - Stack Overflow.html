<!DOCTYPE html>
<html>
<head>
    
    <title>c++ - Problem to Decode H264 video over RTP with ffmpeg (libavcodec) - Stack Overflow</title>
    <link rel="shortcut icon" href="//cdn.sstatic.net/stackoverflow/img/favicon.ico?v=038622610830">
    <link rel="apple-touch-icon image_src" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png?v=fd7230a85918">
    <link rel="search" type="application/opensearchdescription+xml" title="Stack Overflow" href="/opensearch.xml">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:domain" content="stackoverflow.com"/>
    <meta name="og:type" content="website" />
    <meta name="og:image" content="http://cdn.sstatic.net/stackoverflow/img/apple-touch-icon@2.png?v=fde65a5a78c6"/>
    <meta name="og:title" content="Problem to Decode H264 video over RTP with ffmpeg (libavcodec)" />
    <meta name="og:description" content="I set profile_idc, level_idc, extradata et extradata_size of AvCodecContext with the  profile-level-id et sprop-parameter-set of the SDP.

I separate the decoding of Coded Slice, SPS, PPS and " />
    <meta name="og:url" content="http://stackoverflow.com/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec"/>
    <link rel="canonical" href="http://stackoverflow.com/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" />

    
    
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="//cdn.sstatic.net/Js/stub.en.js?v=8e28a257726f"></script>
    <link rel="stylesheet" type="text/css" href="//cdn.sstatic.net/stackoverflow/all.css?v=2fbb3a2661d9">
    
    <link rel="alternate" type="application/atom+xml" title="Feed for question &#39;Problem to Decode H264 video over RTP with ffmpeg (libavcodec)&#39;" href="/feeds/question/3493742">
    <script>
        
        StackExchange.ready(function () {
            StackExchange.using("postValidation", function () {
                StackExchange.postValidation.initOnBlurAndSubmit($('#post-form'), 2, 'answer');
            });

            
            StackExchange.question.init({showAnswerHelp:true,totalCommentCount:3,shownCommentCount:3,highlightColor:'#F4A83D',backgroundColor:'#FFF',questionId:3493742});

            styleCode();

                StackExchange.realtime.subscribeToQuestion('1', '3493742');
            
                    });
    </script>


    <script>
        StackExchange.init({"locale":"en","stackAuthUrl":"https://stackauth.com","serverTime":1401804604,"networkMetaHostname":"meta.stackexchange.com","styleCode":true,"enableUserHovercards":true,"site":{"name":"Stack Overflow","description":"Q&A for professional and enthusiast programmers","isNoticesTabEnabled":true,"recaptchaPublicKey":"6LdchgIAAAAAAJwGpIzRQSOFaO0pU6s44Xt8aTwc","recaptchaAudioLang":"en","nonAsciiTags":true,"enableSocialMediaInSharePopup":true},"user":{"fkey":"82f319152a45400d4a9c44b5e380d00d","isAnonymous":true,"ab":{"question_ask_anonymous_banner":{"v":"friendly_message_c","g":1},"welcome_email":{"v":"4","g":2}}}});
        StackExchange.using.setCacheBreakers({"js/prettify-full.en.js":"bc44831aa7da","js/moderator.en.js":"0f409c40a6dd","js/full-anon.en.js":"52bcaed64bb2","js/full.en.js":"5b939b15b49e","js/wmd.en.js":"02f7704f24d2","js/third-party/jquery.autocomplete.min.js":"e5f01e97f7c3","js/third-party/jquery.autocomplete.min.en.js":"","js/mobile.en.js":"fd43925326dc","js/help.en.js":"56d0a3a560ae","js/tageditor.en.js":"3aec8ce3c025","js/tageditornew.en.js":"dd238cfe04c2","js/inline-tag-editing.en.js":"21223186b436","js/revisions.en.js":"ce4a692d0d20","js/review.en.js":"99d8bf30acce","js/tagsuggestions.en.js":"d1ff9b84abe5","js/post-validation.en.js":"5d443f905c68","js/explore-qlist.en.js":"8b8b631bd679","js/events.en.js":"019bec583db9"});
        StackExchange.using("gps", function() {
             StackExchange.gps.init(true);
        });
        
    </script>
    
        <script>
            StackExchange.ready(function () {
                $('#nav-tour').click(function () {
                    StackExchange.using("gps", function() {
                        StackExchange.gps.track("aboutpage.click", { aboutclick_location: "headermain" }, true);
                    });
                });
            });
        </script>
</head>
<body class="question-page new-topbar">
    <noscript><div id="noscript-padding"></div></noscript>
    <div id="notify-container"></div>
    <div id="overlay-header"></div>
    <div id="custom-header"></div>
<div class="topbar">
    <div class="topbar-wrapper">
        
        <div class="js-topbar-dialog-corral">

<div class="topbar-dialog siteSwitcher-dialog dno">
    <div class="header">
        <h3><a href="//stackoverflow.com">current community</a></h3>
    </div>
    <div class="modal-content current-site-container">
        <ul class="current-site">
                <li>
                        <div class="related-links">
            <a href="http://chat.stackoverflow.com"     data-gps-track="site_switcher.click({ item_type:6 })"
>chat</a>
                    <a href="http://blog.stackoverflow.com"     data-gps-track="site_switcher.click({ item_type:7 })"
>blog</a>
            </div>




    <a href="//stackoverflow.com"
       class="current-site-link site-link js-gps-track"
       data-id="1"
       data-gps-track="
        site_switcher.click({ item_type:3 })">
        <div class="site-icon favicon favicon-stackoverflow" title="Stack Overflow"></div>
        Stack Overflow
    </a>

                </li>
                <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    



    <a href="http://meta.stackoverflow.com"
       class="site-link js-gps-track"
       data-id="552"
       data-gps-track="
            site.switch({ target_site:552, item_type:3 }),
        site_switcher.click({ item_type:4 })">
        <div class="site-icon favicon favicon-stackoverflowmeta" title="Meta Stack Overflow"></div>
        Meta Stack Overflow
    </a>

                </li>
                            <li class="related-site">
                        <div class="L-shaped-icon-container">
        <span class="L-shaped-icon"></span>
    </div>

                    <a class="site-link"
                       href="//careers.stackoverflow.com"
                            data-gps-track="site_switcher.click({ item_type:9 })"
>
                        <div class="site-icon favicon favicon-careers" title="Stack Overflow Careers"></div>
                        Careers 2.0
                    </a>
                </li>
        </ul>
    </div>
    
    <div class="header" id="your-communities-header">
        <h3>
your communities        </h3>
            
    </div>
    <div class="modal-content" id="your-communities-section">
            
            <div class="call-to-login">
                        <a href="https://stackoverflow.com/users/signup?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f3493742%2fproblem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:10 })"
>Sign up</a>
                    or
                    <a href="https://stackoverflow.com/users/login?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f3493742%2fproblem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" class="js-gps-track"     data-gps-track="site_switcher.click({ item_type:11 })"
>log in</a>

                    to customize your list.
            </div>
    </div>
    
    <div class="header">
        <h3><a href="//stackexchange.com/sites">more stack exchange communities</a></h3>
    </div>
    <div class="modal-content">
            <div class="child-content"></div>
    </div>
</div>
        </div>

        <div class="network-items">
            
            <a href="//stackexchange.com" 
               class="topbar-icon icon-site-switcher yes-hover js-site-switcher-button js-gps-track"
               data-gps-track="site_switcher.show"
               title="A list of all 126 Stack Exchange sites">
                <span class="hidden-text">Stack Exchange</span>
            </a>
            
        </div>

        <div class="topbar-links">
            
                <div class="links-container">
                    <span class="topbar-menu-links">
                            <a href="https://stackoverflow.com/users/signup?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f3493742%2fproblem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" class="login-link">sign up</a>
                            <a href="https://stackoverflow.com/users/login?returnurl=http%3a%2f%2fstackoverflow.com%2fquestions%2f3493742%2fproblem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" class="login-link">log in</a>
                            <a href="/tour">tour</a>

                            <a href="#" class="icon-help js-help-button" title="Help Center and other resources">
        help
        <span class="triangle"></span>
    </a>
    <div class="topbar-dialog help-dialog js-help-dialog dno">
        <div class="modal-content">
            <ul>
                <li>
                    <a href="/tour"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:1 })"
>
                        Tour
                        <span class="item-summary">
                            Start here for a quick overview of the site
                        </span>
                    </a>
                </li>
                <li>
                    <a href="/help"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:4 })"
>
                        Help Center
                        <span class="item-summary">
                            Detailed answers to any questions you might have
                        </span>
                    </a>
                </li>
                    <li>
                        <a href="//meta.stackoverflow.com"     class="js-gps-track" data-gps-track="help_popup.click({ item_type:2 })"
>
                            Meta
                            <span class="item-summary">
                                Discuss the workings and policies of this site
                            </span>
                        </a>
                    </li>
            </ul>
        </div>
    </div>

                            <a href="//careers.stackoverflow.com">careers 2.0</a>
                    </span>
                </div>

			<div class="search-container">
                <form id="search" action="/search" method="get" autocomplete="off">
                    <input name="q" type="text" placeholder="search" value="" tabindex="1" autocomplete="off" maxlength="240" />
                </form>
			</div>
            	
        </div>      
    </div> 
</div>
<script>
    StackExchange.ready(function () { StackExchange.topbar.init(); });
</script>
    <div class="container">
        <div id="header" class=headeranon>
            <br class="cbt">
            <div id="hlogo">
                <a href="/">
                    Stack Overflow
                </a>
            </div>
            <div id="hmenus">
                <div class="nav mainnavs mainnavsanon">
                    <ul>
                            <li class="youarehere"><a id="nav-questions" href="/questions">Questions</a></li>
                            <li><a id="nav-tags" href="/tags">Tags</a></li>
                            <li><a id="nav-tour" href="/about">Tour</a></li>
                            <li><a id="nav-users" href="/users">Users</a></li>
                    </ul>
                </div>
                <div class="nav askquestion">
                    <ul>
                        <li>
                            <a id="nav-askquestion"  href="/questions/ask">Ask Question</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        



        <div id="content">
            

<div itemscope itemtype="http://schema.org/Article">
	<link itemprop="image" href="//cdn.sstatic.net/stackoverflow/img/apple-touch-icon.png">
			<!--googleoff: all-->

<div id="herobox-mini">
    <div id="hero-content">
        <span id="controls">
            <a href="/about" id="tell-me-more" class="button">Take the 2-minute tour</a>
            <span id="close"><a title="click to dismiss">&times;</a></span>
        </span>
        <div id="blurb">
            Stack Overflow is a question and answer site for professional and enthusiast programmers. It&#39;s 100% free, no registration required.
        </div>        
    </div>
    <script>
        $('#tell-me-more').click(function () {
            var clickSource = $("body").attr("class") + '-mini';
            if ($("body").hasClass("questions-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("question-page")) {
                clickSource = 'questionpagemini';
            } else if ($("body").hasClass("home-page")) {
                clickSource = 'homepagemini';
            }

            StackExchange.using("gps", function () {
                StackExchange.gps.track("aboutpage.click", { aboutclick_location: clickSource } , true);
            });
        });
        $('#herobox-mini #close').click(function () {
            StackExchange.using("gps", function () {
                StackExchange.gps.track("hero.action", { hero_action_type: "close" }, true);
            });
            $.cookie("hero", "none", { path: "/" });
            var $hero = $("#herobox-mini");
            $hero.slideUp('fast', function () { $hero.remove(); });
            return false;
        });
    </script>
</div>
			<!--googleon: all-->
			<div id="question-header">
			<h1 itemprop="name"><a href="/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec" class="question-hyperlink">Problem to Decode H264 video over RTP with ffmpeg (libavcodec)</a></h1>
		</div>
			<div id="mainbar">

			

<div class="question" data-questionid="3493742"  id="question">

    <script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk26279629",4).setZone(43) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk26279629">
            </div>    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="3493742">
    <a class="vote-up-off" title="This question shows research effort; it is useful and clear">up vote</a>
    <span class="vote-count-post ">4</span>
    <a class="vote-down-off" title="This question does not show any research effort; it is unclear or not useful">down vote</a>
    
    <a class="star-off" href="#" title="This is a favorite question (click again to undo)">favorite</a>
    <div class="favoritecount"><b>13</b></div>   

</div>

            </td>
            
<td class="postcell">
<div>
    <div class="post-text" itemprop="description">

        <p>I set profile_idc, level_idc, extradata et extradata_size of AvCodecContext with the  profile-level-id et sprop-parameter-set of the SDP.</p>

<p>I separate the decoding of Coded Slice, SPS, PPS and NAL_IDR_SLICE packet :</p>

<h2>Init:</h2>

<p>uint8_t start_sequence[]= {0, 0, 1};
int size= recv(id_de_la_socket,(char*) rtpReceive,65535,0);</p>

<h2>Coded Slice :</h2>

<pre><code>char *z = new char[size-16+sizeof(start_sequence)];
    memcpy(z,&amp;start_sequence,sizeof(start_sequence));
    memcpy(z+sizeof(start_sequence),rtpReceive+16,size-16);
    ConsumedBytes = avcodec_decode_video(codecContext,pFrame,&amp;GotPicture,(uint8_t*)z,size-16+sizeof(start_sequence));
    delete z;
</code></pre>

<p>Result: ConsumedBytes >0 and GotPicture >0  (often)</p>

<h2>SPS and PPS :</h2>

<p>identical code.
Result: ConsumedBytes >0 and GotPicture =0</p>

<p>It's normal I think</p>

<p>When I find a new couple SPS/PPS, I update extradata and extrada_size with the payloads of this packet and their size.</p>

<h2>NAL_IDR_SLICE :</h2>

<p>The Nal unit type is 28 =>idr Frame are fragmented therefor I tryed two method to decode</p>

<p>1)  I prefix the first fragment (without RTP header) with the sequence 0x000001 and send it to avcodec_decode_video. Then I send the rest of fragments to this function.</p>

<p>2) I prefix the first fragment (without RTP header) with the sequence 0x000001 and concatenate the rest of fragments to it. I send this buffer to decoder.</p>

<p>In both cases, I have no error (ConsumedBytes >0) but I detect no frame (GotPicture = 0) ...</p>

<p>What is the problem ?</p>

    </div>
    <div class="post-taglist">
        <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/h.264" class="post-tag" title="show questions tagged &#39;h.264&#39;" rel="tag">h.264</a> <a href="/questions/tagged/rtp" class="post-tag" title="show questions tagged &#39;rtp&#39;" rel="tag">rtp</a> <a href="/questions/tagged/libavcodec" class="post-tag" title="show questions tagged &#39;libavcodec&#39;" rel="tag">libavcodec</a> 
    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/q/3493742" title="short permalink to this question" class="short-link" id="link-post-3493742">share</a><span class="lsep">|</span><a href="/posts/3493742/edit" class="suggest-edit-post" title="">improve this question</a></div>        
    </td>
    <td class="post-signature owner">
        <div class="user-info ">
    <div class="user-action-time">
        asked <span title="2010-08-16 13:49:01Z" class="relativetime">Aug 16 '10 at 13:49</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/421793/bben"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/bea2beb2f00b259c020430ea97440f82?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/421793/bben">bben</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">23</span><span title="1 gold badge"><span class="badge1"></span><span class="badgecount">1</span></span><span title="1 silver badge"><span class="badge2"></span><span class="badgecount">1</span></span><span title="3 bronze badges"><span class="badge3"></span><span class="badgecount">3</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</div>
</td>
        </tr>
                <tr>
            <td class="special-status" colspan="2">
                
            </td>
        </tr>
    <tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3493742" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-3659000" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Any comment from the ffmpeg mailing list ?</span>
                &ndash;&nbsp;
                    <a href="/users/135549/neuro"
                       title="6365 reputation"
                       class="comment-user">neuro</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-17 11:17:34Z" class="relativetime-clean">Aug 17 '10 at 11:17</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-3659336" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Why 0x000001? This is h264 not MPEG4.</span>
                &ndash;&nbsp;
                    <a href="/users/191164/cipi"
                       title="5100 reputation"
                       class="comment-user">Cipi</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-17 11:51:54Z" class="relativetime-clean">Aug 17 '10 at 11:51</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-3681326" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Read my answer again, I explained some more things that might concern you.</span>
                &ndash;&nbsp;
                    <a href="/users/191164/cipi"
                       title="5100 reputation"
                       class="comment-user">Cipi</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-19 09:30:36Z" class="relativetime-clean">Aug 19 '10 at 9:30</span></span>
                                                                            </div>
        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-3493742" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid answering questions in comments." 
				>add comment</a>
    </td>
</tr>        </table>
</div>


			<div id="answers">

				<a name="tab-top"></a>
				<div id="answers-header">
					<div class="subheader answers-subheader">
						<h2>
								2 Answers
						</h2>
						<div>
							<div id="tabs">
        <a href="/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec?answertab=active#tab-top" title="Answers with the latest activity first">active</a>
        <a href="/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec?answertab=oldest#tab-top" title="Answers in the order they were provided">oldest</a>
        <a class="youarehere" href="/questions/3493742/problem-to-decode-h264-video-over-rtp-with-ffmpeg-libavcodec?answertab=votes#tab-top" title="Answers with the highest score first">votes</a>
</div>
						</div>
					</div>    
				</div>    




  
<a name="3501968"></a>
<div id="answer-3501968" class="answer accepted-answer" data-answerid="3501968" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="3501968">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">13</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


        <span class="vote-accepted-on load-accepted-answer-date" title="loading when this answer was accepted...">accepted</span>
</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>In RTP all H264 I-Frames (IDRs) are usualy fragmented. When you receive RTP you first must skip the header (usualy first 12 bytes) and then get to the NAL unit (first payload byte). If the NAL is 28 (1C) then it means that following payload represents one H264 IDR (I-Frame) fragment and that you need to collect all of them to reconstruct H264 IDR (I-Frame).</p>

<p>Fragmentation occurs because of the limited MTU, and much larger IDR. One fragment can look like this:</p>

<p><strong>Fragment that has START BIT = 1:</strong></p>

<pre><code>First byte:  [ 3 NAL UNIT BITS | 5 FRAGMENT TYPE BITS] 
Second byte: [ START BIT | END BIT | RESERVED BIT | 5 NAL UNIT BITS] 
Other bytes: [... IDR FRAGMENT DATA...]
</code></pre>

<p><strong>Other fragments:</strong></p>

<pre><code>First byte:  [ 3 NAL UNIT BITS | 5 FRAGMENT TYPE BITS]  
Other bytes: [... IDR FRAGMENT DATA...]
</code></pre>

<p>To reconstruct IDR you must collect this info:</p>

<pre><code>int fragment_type = Data[0] &amp; 0x1F;
int nal_type = Data[1] &amp; 0x1F;
int start_bit = Data[1] &amp; 0x80;
int end_bit = Data[1] &amp; 0x40;
</code></pre>

<p>If <code>fragment_type == 28</code> then payload following it is one fragment of IDR. Next check is <code>start_bit</code> set, if it is, then that fragment is the first one in a sequence. You use it to reconstruct IDR's NAL byte by taking the first 3 bits from first payload byte <code>(3 NAL UNIT BITS)</code> and combine them with last 5 bits from second payload byte <code>(5 NAL UNIT BITS)</code> so you would get a byte like this <code>[3 NAL UNIT BITS | 5 NAL UNIT BITS]</code>. Then write that NAL byte first into a clear buffer with all other following bytes from that fragment. Remember to skip first byte in a sequence since it is not a part of IDR, but only identifies the fragment.</p>

<p>If <code>start_bit</code> and <code>end_bit</code> are 0 then just write the payload (skipping first payload byte that identifies the fragment) to the buffer.</p>

<p>If start_bit is 0 and end_bit is 1, that means that it is the last fragment, and you just write its payload (skipping the first byte that identifies the fragment) to the buffer, and now you have your IDR reconstructed.</p>

<p>If you need some code, just ask in comment, I'll post it, but I think this is pretty clear how to do... =)</p>

<p><strong>CONCERNING THE DECODING</strong></p>

<p>It crossed my mind today why you get error on decoding the IDR (I presumed that you have reconstructed it good). How are you building your AVC Decoder Configuration Record? Does the lib that you use have that automated? If not, and you havent heard of this, continue reading...</p>

<p>AVCDCR is specified to allow decoders to quickly parse all the data they need to decode H264 (AVC) video stream. And the data is following:</p>

<ul>
<li>ProfileIDC</li>
<li>ProfileIOP</li>
<li>LevelIDC</li>
<li>SPS (Sequence Parameter Sets)</li>
<li>PPS (Picture Parameter Sets)</li>
</ul>

<p>All this data is sent in RTSP session in SDP under the fields: <code>profile-level-id</code> and <code>sprop-parameter-sets</code>.</p>

<p><strong>DECODING PROFILE-LEVEL-ID</strong></p>

<p>Prifile level ID string is divided into 3 substrings, each 2 characters long: </p>

<p><code>[PROFILE IDC][PROFILE IOP][LEVEL IDC]</code></p>

<p>Each substring represents one byte <strong>in base16</strong>! So, if Profile IDC is 28, that means it is actualy 40 in base10. Later you will use base10 values to construct AVC Decoder Configuration Record.</p>

<p><strong>DECODING SPROP-PARAMETER-SETS</strong></p>

<p>Sprops are usualy 2 strings (could be more) that are comma separated, and <strong>base64 encoded</strong>! You can decode both of them but there is no need to. Your job here is just to convert them from base64 string into byte array for later use. Now you have 2 byte arrays, first array us SPS, second one is PPS.</p>

<p><strong>BUILDING THE AVCDCR</strong></p>

<p>Now, you have all you need to build AVCDCR, you start by making new clean buffer, now write these things in it in the order explained here:</p>

<p>1 - Byte that has value <strong>1</strong> and represents version </p>

<p>2 - Profile IDC byte</p>

<p>3 - Prifile IOP byte</p>

<p>4 - Level IDC byte</p>

<p>5 - Byte with value 0xFF (google the AVC Decoder Configuration Record to see what this is)</p>

<p>6 - Byte with value 0xE1</p>

<p>7 - Short with value of the SPS array length</p>

<p>8 - SPS byte array</p>

<p>9 - Byte with the number of PPS arrays (you could have more of them in sprop-parameter-set)</p>

<p>10 - Short with the length of following PPS array</p>

<p>11 - PPS array </p>

<p><strong>DECODING VIDEO STREAM</strong></p>

<p>Now you have byte array that tells the decoder how to decode H264 video stream. I believe that you need this if your lib doesn't build it itself from SDP...</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/3501968" title="short permalink to this answer" class="short-link" id="link-post-3501968">share</a><span class="lsep">|</span><a href="/posts/3501968/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
    <td align="right" class="post-signature">
<div class="user-info ">
    <div class="user-action-time">
        <a href="/posts/3501968/revisions" title="show all edits to this post">edited <span title="2012-06-11 08:52:45Z" class="relativetime">Jun 11 '12 at 8:52</span></a>
    </div>
    <div class="user-gravatar32">
        
    </div>
    <div class="user-details">
        <br>
        
    </div>
</div>    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info user-hover">
    <div class="user-action-time">
        answered <span title="2010-08-17 11:38:09Z" class="relativetime">Aug 17 '10 at 11:38</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/191164/cipi"><div class="gravatar-wrapper-32"><img src="https://www.gravatar.com/avatar/3f3e6aff31afb1fab5957cecb367e768?s=32&d=identicon&r=PG" alt=""></div></a>
    </div>
    <div class="user-details">
        <a href="/users/191164/cipi">Cipi</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">5,100</span><span title="5 gold badges"><span class="badge1"></span><span class="badgecount">5</span></span><span title="22 silver badges"><span class="badge2"></span><span class="badgecount">22</span></span><span title="42 bronze badges"><span class="badge3"></span><span class="badgecount">42</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
    <tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3501968" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-3681596" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">This library can build it itself but I build it myself.With ffmpeg, this parameter are stored in a structure (AvCodecContext). I will try building ACDR with your method.  thx</span>
                &ndash;&nbsp;
                    <a href="/users/421793/bben"
                       title="23 reputation"
                       class="comment-user owner">bben</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-19 10:03:45Z" class="relativetime-clean">Aug 19 '10 at 10:03</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-3693559" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Ok, then you are not reconstructing IDR like you should... check once more the process. Hope I helped... =)</span>
                &ndash;&nbsp;
                    <a href="/users/191164/cipi"
                       title="5100 reputation"
                       class="comment-user">Cipi</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-20 11:08:10Z" class="relativetime-clean">Aug 20 '10 at 11:08</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-3693699" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">It&#39;s good: ACDR is recognized by the decoder and parameters are set. Decoder does not decode the rest but it is due to another parameters of ffmpeg I think. I thank you for your help : I have already made significant progress.</span>
                &ndash;&nbsp;
                    <a href="/users/421793/bben"
                       title="23 reputation"
                       class="comment-user owner">bben</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-20 11:24:56Z" class="relativetime-clean">Aug 20 '10 at 11:24</span></span>
                    <span class="edited-yes" title="this comment was edited 2 times"></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-14334840" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">This is a really good answer, unfortunately you wrote the second byte of the FU-A incorrect. It should be [ START | END | RESERVED | TYPE ] that is, END and RESERVED should change places. See RFC3984 (<a href="http://www.ietf.org/rfc/rfc3984.txt" rel="nofollow">ietf.org/rfc/rfc3984.txt</a>).</span>
                &ndash;&nbsp;
                    <a href="/users/936397/alexander-olsson"
                       title="521 reputation"
                       class="comment-user">Alexander Olsson</a>
                <span class="comment-date" dir="ltr"><span title="2012-06-11 07:46:57Z" class="relativetime-clean">Jun 11 '12 at 7:46</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-14336074" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">Yes I see, thank you for the comment! I did the <code>start_bit</code>and the <code>end_bit</code> bit masking good thought... :P</span>
                &ndash;&nbsp;
                    <a href="/users/191164/cipi"
                       title="5100 reputation"
                       class="comment-user">Cipi</a>
                <span class="comment-date" dir="ltr"><span title="2012-06-11 08:54:11Z" class="relativetime-clean">Jun 11 '12 at 8:54</span></span>
                                                                            </div>
        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-3501968" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>
<script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk75728852",4).setZone(44) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk75728852">
            </div>
  
<a name="3495573"></a>
<div id="answer-3495573" class="answer" data-answerid="3495573" >
    <table>
        <tr>
            <td class="votecell">
                

<div class="vote">
    <input type="hidden" name="_id_" value="3495573">
    <a class="vote-up-off" title="This answer is useful">up vote</a>
    <span class="vote-count-post ">1</span>
    <a class="vote-down-off" title="This answer is not useful">down vote</a>
    


</div>

            </td>
            


<td class="answercell">
    <div class="post-text">
            <p>I don't know about the rest of your implementation, but it seems likely the 'fragments' you are receiving are NAL units. Therefore each, each may need the the NALU start-code (<code>00 00 01</code> or <code>00 00 00 01</code>) appended when you reconstruct the bitstream before sending it to ffmpeg.</p>

<p>At any rate, you might find the RFC for H264 RTP packetization useful:</p>

<p><a href="http://www.rfc-editor.org/rfc/rfc3984.txt" rel="nofollow">http://www.rfc-editor.org/rfc/rfc3984.txt</a></p>

<p>Hope this helps!</p>

    </div>
    <table class="fw">
    <tr>
    <td class="vt">
<div class="post-menu"><a href="/a/3495573" title="short permalink to this answer" class="short-link" id="link-post-3495573">share</a><span class="lsep">|</span><a href="/posts/3495573/edit" class="suggest-edit-post" title="">improve this answer</a></div>                    </td>
            


    <td align="right" class="post-signature">   
       

    <div class="user-info ">
    <div class="user-action-time">
        answered <span title="2010-08-16 17:21:23Z" class="relativetime">Aug 16 '10 at 17:21</span>
    </div>
    <div class="user-gravatar32">
        <a href="/users/12451/scott"><div><img src="https://www.gravatar.com/avatar/7ac7eefa5c2e62fd63c0a85ec8b45de3?s=32&d=identicon&r=PG&f=1" alt="" width="32" height="32"></div></a>
    </div>
    <div class="user-details">
        <a href="/users/12451/scott">Scott</a><br>
        <span class="reputation-score" title="reputation score " dir="ltr">543</span><span title="5 silver badges"><span class="badge2"></span><span class="badgecount">5</span></span><span title="14 bronze badges"><span class="badge3"></span><span class="badgecount">14</span></span>
    </div>
</div>
    </td>
    </tr>
    </table>
</td>
        </tr>
    <tr>
    <td class="votecell"></td>
    <td>
	    <div id="comments-3495573" class="comments" data-localized="true">
		    <table>
			    <tbody data-remaining-comments-count="0" 
			           data-addlink-html="add comment" 
			           data-addlink-disabled="true">

    <tr id="comment-3660740" class="comment">
        <td>
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                &nbsp;&nbsp;
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">I don&#39;t have enough karma to comment on your question or answer below, but are you appending the NALU startcode before to EACH &#39;fragment&#39;?</span>
                &ndash;&nbsp;
                    <a href="/users/12451/scott"
                       title="543 reputation"
                       class="comment-user">Scott</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-17 13:59:05Z" class="relativetime-clean">Aug 17 '10 at 13:59</span></span>
                                                                            </div>
        </td>
    </tr>
    <tr id="comment-3668302" class="comment">
        <td class="comment-actions">
            <table>
                <tbody>
                    <tr>
                        <td class=" comment-score">
                                <span title="number of &#39;useful comment&#39; votes received"
                                      class="cool">1</span>
                        </td>
                        <td>
                                &nbsp;
                        </td>
                    </tr>
                </tbody>
            </table>   
        </td>
        <td class="comment-text">
            <div style="display: block;" class="comment-body">
                <span class="comment-copy">You don&#39;t need to do that... Fragments are parts of one IDR. NALU is transmitted only in first fragment, not each one. To decode it, you totally don&#39;t need to add no start code, because NAL unit defines the H264 payload that follows it (lower 5 bits do that).</span>
                &ndash;&nbsp;
                    <a href="/users/191164/cipi"
                       title="5100 reputation"
                       class="comment-user">Cipi</a>
                <span class="comment-date" dir="ltr"><span title="2010-08-18 07:00:38Z" class="relativetime-clean">Aug 18 '10 at 7:00</span></span>
                                                                            </div>
        </td>
    </tr>
			    </tbody>
		    </table>
	    </div>
			<a id="comments-link-3495573" data-rep=50 data-anon=true
			   class="comments-link disabled-link" 
			   title="Use comments to ask for more information or suggest improvements. Avoid comments like “+1” or “thanks”." 
				>add comment</a>
    </td>
</tr>    </table>
</div>
				<div class="question-status">
        <h2>                    <b>protected</b> by <a href="/users/-1/community">Community</a><span class="mod-flair" title="moderator">♦</span> <span title="2012-02-25 16:03:46Z" class="relativetime">Feb 25 '12 at 16:03</span>
</h2>
        <p>
Thank you for your interest in this question. 
Because it has attracted low-quality answers, posting an answer now requires 10 <a href="/help/whats-reputation">reputation</a> on this site.
<br /><br />
Would you like to answer one of these <a href="/unanswered?fromProtectedNotice=true">unanswered questions</a> instead?
</p>
    </div>


						<h2 class="bottom-notice" data-loc="1">
Not the answer you&#39;re looking for?							Browse other questions tagged <a href="/questions/tagged/c%2b%2b" class="post-tag" title="show questions tagged &#39;c++&#39;" rel="tag">c++</a> <a href="/questions/tagged/h.264" class="post-tag" title="show questions tagged &#39;h.264&#39;" rel="tag">h.264</a> <a href="/questions/tagged/rtp" class="post-tag" title="show questions tagged &#39;rtp&#39;" rel="tag">rtp</a> <a href="/questions/tagged/libavcodec" class="post-tag" title="show questions tagged &#39;libavcodec&#39;" rel="tag">libavcodec</a>  or <a href="/questions/ask">ask your own question</a>.						</h2>
			</div>
		</div>
				<div id="sidebar" class="show-votes">
						    <div class="module question-stats">
			        <table id="qinfo">
			            <tr>
			                <td>
			                    <p class="label-key">asked</p>
			                </td>
			                <td style="padding-left: 10px">
			                    <p class="label-key" title="2010-08-16 13:49:01Z"><b>3 years ago</b></p>
			                </td>
			            </tr>
			            <tr>
			                <td>
			                    <p class="label-key">viewed</p>
			                </td>

			                <td style="padding-left: 10px">
			                    <p class="label-key">
			                        <b>17658 times</b>
			                    </p>
			                </td>
			            </tr>
			                <tr>
			                    <td>
			                        <p class="label-key">active</p>
			                    </td>
			                    <td style="padding-left: 10px">
			                        <p class="label-key"><b><a href="?lastactivity" class="lastactivity-link" title="2012-06-11 08:52:45Z">1 year ago</a></b></p>
			                    </td>
			                </tr>
			        </table>
			    </div>
						
			<script>
                var ados = ados || {};ados.run = ados.run || [];
                ados.run.push(function() { ados_add_placement(22,8277,"adzerk1492458028",17).setZone(45) ; });                    
            </script>
            <div class="everyonelovesstackoverflow" id="adzerk1492458028">
            </div>  
    <div id="hireme">
        <script>
window.careers_adurl="//careers.stackoverflow.com/gethired/js",window.careers_cssurl="//cdn-careers.sstatic.net/careers/gethired/sidebar.min.css?v=88f3fd5e2263",window.careers_leaderboardcssurl="{leaderboardcssurl}",window.careers_companycssurl="//cdn-careers.sstatic.net/careers/gethired/company",window.careers_adselector="div#hireme",StackExchange.ready(function(){$.ajax({url:"//cdn-careers.sstatic.net/careers/gethired/loader.min.js?v=3984021d4bb9",dataType:"script",cache:!0})});        </script>
    </div>
			<div style="margin-bottom: 10px;">
        

<style type="text/css">
#newsletter-ad {
    width: 190px;
    height: 250px;
    overflow: hidden;
    background: url('//cdn.sstatic.net/stackoverflow/img/newsletter-ad.png');
    padding: 0 15px 0 15px;
}
#newsletter-ad-header {
    margin-top: 60px;
}
#newsletter-ad ul {
    margin: 1em 0 1em 1.5em;
}
#newsletter-ad ul li {
    margin-bottom: 5px;
}
#newsletter-signup-container {
    text-align: center;
}
#newsletter-preview-container {
    margin-top: 10px;
    text-align: center;
}
#newsletter-email-input {
    width: 200px;
}
</style>

<script>
    StackExchange.ready(function () {
        StackExchange.newsletterAd.init();
    });
</script>

<div id="newsletter-ad">
    <p id="newsletter-ad-header">Get the <b>weekly newsletter!</b></p>
    <ul>
        <li>Top questions and answers</li>
        <li>Important announcements</li>
        <li>Unanswered questions</li>
    </ul>
    <div id="newsletter-signup-container"><input id="newsletter-signup" type="button" value="Sign up for the newsletter" /></div>
    <p id="newsletter-preview-container">see an <a href="http://stackexchange.com/newsletters/newsletter?site=stackoverflow.com" id="newsletter-preview">example newsletter</a></p>
    <div class="dno">
        
<p class="privacy-policy-agreement">
By subscribing, you agree to the <a href='http://stackexchange.com/legal/privacy-policy' target='_blank'>privacy policy</a> and <a href='http://stackexchange.com/legal/terms-of-service' target='_blank'>terms of service</a>.</p>
<input type="hidden" name="legalLinksShown" value="1" />
    </div>
</div>

    </div>  
    
            <div class="module sidebar-linked">
	<h4 id="h-linked">Linked</h4>
	<div class="linked" data-tracker="lq=1">
<div class="spacer">
	<a href="/q/15263458" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes answered-accepted default">9</div>
	</a>
	<a href="/questions/15263458/h-264-muxed-to-mp4-using-libavformat-not-playing-back" class="question-hyperlink">H.264 muxed to MP4 using libavformat not playing back</a>
</div><div class="spacer">
	<a href="/q/15404047" title="Vote score (upvotes - downvotes)">
		<div class="answer-votes  default">1</div>
	</a>
	<a href="/questions/15404047/how-to-convert-h-264-udp-packets-to-playable-media-stream-or-file-defragmentati" class="question-hyperlink">How to convert H.264 UDP packets to playable media stream or file (defragmentation)</a>
</div>			</div>
</div>

				<div class="module sidebar-related">
					<h4 id="h-related">Related</h4>
                    <div class="related js-gps-related-questions" data-tracker="rq=1">
                        <div class="spacer">
<a href="/q/2911798" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">3
    </div>
</a><a href="/questions/2911798/ffmpeg-encoding-rgb-images-to-h264" class="question-hyperlink">FFMpeg encoding RGB images to H264</a>
</div>
<div class="spacer">
<a href="/q/5928823" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/5928823/using-directx-api-to-view-h264-stream-decoded-by-ffmpeg" class="question-hyperlink">Using DirectX api to view h264 stream decoded by FFMPEG</a>
</div>
<div class="spacer">
<a href="/q/5964142" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">20
    </div>
</a><a href="/questions/5964142/raw-h264-frames-in-mpegts-container-using-libavcodec" class="question-hyperlink">Raw H264 frames in mpegts container using libavcodec</a>
</div>
<div class="spacer">
<a href="/q/6756770" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">1
    </div>
</a><a href="/questions/6756770/libavcodec-how-to-tell-end-of-access-unit-when-decoding-h-264-stream" class="question-hyperlink">Libavcodec: How to tell end of access unit when decoding H.264 stream</a>
</div>
<div class="spacer">
<a href="/q/9618369" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/9618369/h-264-over-rtp-identify-sps-and-pps-frames" class="question-hyperlink">H.264 over RTP - Identify SPS and PPS Frames</a>
</div>
<div class="spacer">
<a href="/q/9678247" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/9678247/how-to-decode-wmp3-video-using-libavcodec-ffmpeg" class="question-hyperlink">how to decode wmp3 video using libavcodec? (ffmpeg)</a>
</div>
<div class="spacer">
<a href="/q/10143753" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">8
    </div>
</a><a href="/questions/10143753/streaming-h-264-over-rtp-with-libavformat" class="question-hyperlink">streaming H.264 over RTP with libavformat</a>
</div>
<div class="spacer">
<a href="/q/10562549" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">2
    </div>
</a><a href="/questions/10562549/send-android-h264-capture-over-a-rtp-stream" class="question-hyperlink">Send Android h264 capture over a rtp stream</a>
</div>
<div class="spacer">
<a href="/q/18857737" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes answered-accepted default">1
    </div>
</a><a href="/questions/18857737/decoding-h264-frames-from-rtp-stream" class="question-hyperlink">Decoding h264 frames from RTP stream</a>
</div>
<div class="spacer">
<a href="/q/21692608" title="Vote score (upvotes - downvotes)">
    <div class="answer-votes default">0
    </div>
</a><a href="/questions/21692608/how-to-know-the-packet-order-in-rtp-h264-stream" class="question-hyperlink">How to know the packet order in RTP H264 Stream</a>
</div>

                    </div>
				</div>
            
<div id="hot-network-questions" class="module">
    <h4>
        <a href="//stackexchange.com/questions?tab=hot" 
           class="js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:1, location:11 })">
            Hot Network Questions
        </a>
    </h4>
    <ul>
            <li >
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="http://tex.stackexchange.com/questions/182933/auto-detect-conditional-probabilities-in-macro" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    auto-detect conditional probabilities in macro
                </a>

            </li>
            <li >
                <div class="favicon favicon-music" title="Musical Practice &amp; Performance Stack Exchange"></div><a href="http://music.stackexchange.com/questions/18975/why-do-wind-bands-use-a-concert-bb-for-tuning" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:240 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why do wind bands use a concert Bb for tuning?
                </a>

            </li>
            <li >
                <div class="favicon favicon-scifi" title="Science Fiction &amp; Fantasy Stack Exchange"></div><a href="http://scifi.stackexchange.com/questions/58473/why-do-muggle-borns-get-taught-magic" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:186 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why Do Muggle Borns Get Taught Magic?
                </a>

            </li>
            <li >
                <div class="favicon favicon-gis" title="Geographic Information Systems Stack Exchange"></div><a href="http://gis.stackexchange.com/questions/99792/creating-numpy-array-with-variable-number-of-fields-to-test-arcpy-da-extendtable" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:79 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Creating numpy.array with variable number of fields to test arcpy.da.ExtendTable performance?
                </a>

            </li>
            <li >
                <div class="favicon favicon-apple" title="Ask Different"></div><a href="http://apple.stackexchange.com/questions/132673/what-machines-will-os-x-10-10-yosemite-run-on" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:118 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What machines will OS X 10.10 (Yosemite) run on?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-gis" title="Geographic Information Systems Stack Exchange"></div><a href="http://gis.stackexchange.com/questions/99783/why-does-the-file-size-increase-after-i-clipped-the-polygons-to-be-smaller" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:79 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why does the file size increase after I clipped the polygons to be smaller?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-askubuntu" title="Ask Ubuntu"></div><a href="http://askubuntu.com/questions/476212/how-to-add-a-new-hard-drive-to-ubuntu" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:89 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How to add a new hard drive to Ubuntu?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-movies" title="Movies &amp; TV Stack Exchange"></div><a href="http://movies.stackexchange.com/questions/19923/how-are-viewing-figures-gathered" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:367 }); posts_hot_network.click({ item_type:2, location:11 })">
                    How are viewing figures gathered?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="http://tex.stackexchange.com/questions/182906/ugly-usepackagetimes-examples" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Ugly \usepackage{times} examples
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-movies" title="Movies &amp; TV Stack Exchange"></div><a href="http://movies.stackexchange.com/questions/19892/what-is-the-biggest-crossover-universe-in-tv" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:367 }); posts_hot_network.click({ item_type:2, location:11 })">
                    What is the biggest crossover universe in TV?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-askubuntu" title="Ask Ubuntu"></div><a href="http://askubuntu.com/questions/476137/does-ubuntu-touch-consume-less-power-than-android" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:89 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Does Ubuntu Touch consume less power than Android?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-islam" title="Islam Stack Exchange"></div><a href="http://islam.stackexchange.com/questions/13324/why-take-mohammads-word" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:455 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why take Mohammad&#39;s word?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-codegolf" title="Programming Puzzles &amp; Code Golf Stack Exchange"></div><a href="http://codegolf.stackexchange.com/questions/28672/code-that-will-only-execute-once" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:200 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Code that will only execute once
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-travel" title="Travel Stack Exchange"></div><a href="http://travel.stackexchange.com/questions/28913/do-nepalese-authorities-care-about-everest-climb-fairness" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:273 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Do Nepalese authorities care about Everest climb fairness?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-stackoverflow" title="Stack Overflow"></div><a href="http://stackoverflow.com/questions/24007886/are-there-any-consequences-from-using-this-to-initialise-a-class" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:1 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Are there any consequences from using *this to initialise a class?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-rpg" title="Role-playing Games Stack Exchange"></div><a href="http://rpg.stackexchange.com/questions/39460/mithril-breastplate-armor-expert-seems-ridiculous" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:122 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Mithril Breastplate + Armor Expert seems ridiculous
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-physics" title="Physics Stack Exchange"></div><a href="http://physics.stackexchange.com/questions/116452/why-did-high-quality-mirrors-use-aluminum-coatings-instead-of-silver" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:151 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why did high quality mirrors use aluminum coatings instead of silver?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-photo" title="Photography Stack Exchange"></div><a href="http://photo.stackexchange.com/questions/50740/camera-on-boat-worth-the-risk" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:61 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Camera on boat worth the risk?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-aviation" title="Aviation Stack Exchange"></div><a href="http://aviation.stackexchange.com/questions/5182/why-is-the-flight-going-north-just-to-go-south" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:528 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Why is the flight going north just to go south?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-academia" title="Academia Stack Exchange"></div><a href="http://academia.stackexchange.com/questions/21825/requesting-review-of-short-proof-by-professor" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:415 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Requesting review of short proof by professor
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-tex" title="TeX - LaTeX Stack Exchange"></div><a href="http://tex.stackexchange.com/questions/182911/problem-aligning-multiple-pgfplots-due-to-different-axis-label-sizes" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:85 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Problem aligning multiple pgfplots due to different axis label sizes
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-mathoverflow" title="MathOverflow"></div><a href="http://mathoverflow.net/questions/168896/is-the-total-space-of-a-family-of-normal-varieties-a-normal-variety" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:504 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Is the total space of a family of normal varieties a normal variety?
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-codereview" title="Code Review Stack Exchange"></div><a href="http://codereview.stackexchange.com/questions/52315/check-if-a-number-is-divisible-by-3-efficiently" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:196 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Check if a number is divisible by 3, efficiently
                </a>

            </li>
            <li class="dno js-hidden">
                <div class="favicon favicon-movies" title="Movies &amp; TV Stack Exchange"></div><a href="http://movies.stackexchange.com/questions/19871/equivalent-of-555-for-ip-addresses" class="js-gps-track" data-gps-track="site.switch({ item_type:11, target_site:367 }); posts_hot_network.click({ item_type:2, location:11 })">
                    Equivalent of 555 for IP addresses
                </a>

            </li>
    </ul>

        <a href="#" 
           class="show-more js-show-more js-gps-track" 
           data-gps-track="posts_hot_network.click({ item_type:3, location:11 })">
            more hot questions
        </a>
</div>
		</div>
	
<div id="feed-link">
    <div id="feed-link-text">
        <a href="/feeds/question/3493742" title="feed of this question and its answers">
            <span class="feed-icon"></span>question feed
        </a>
    </div>
</div>	<script>
StackExchange.ready(function(){$.get('/posts/3493742/ivc/fb52');});
</script>
<noscript>
    <div><img src="/posts/3493742/ivc/fb52" class="dno" alt="" width="0" height="0"></div>
</noscript><div style="display:none" id="prettify-lang">lang-cpp</div></div>



        </div>
    </div>
    <div id="footer" class="categories">
        <div class="footerwrap">
            <div id="footer-menu">
                <div class="top-footer-links">
                        <a href="/about">about</a>
                    <a href="/help">help</a>
                        <a href="/help/badges">badges</a>
                    <a href="http://blog.stackoverflow.com?blb=1">blog</a>
                        <a href="http://chat.stackoverflow.com">chat</a>
                    <a href="http://data.stackexchange.com">data</a>
                    <a href="http://stackexchange.com/legal">legal</a>
                    <a href="http://stackexchange.com/legal/privacy-policy">privacy policy</a>
                    <a href="http://stackexchange.com/about/hiring">jobs</a>
                    <a href="http://engine.adzerk.net/r?e=eyJhdiI6NDE0LCJhdCI6MjAsImNtIjo5NTQsImNoIjoxMTc4LCJjciI6Mjc3NiwiZG0iOjQsImZjIjoyODYyLCJmbCI6Mjc1MSwibnciOjIyLCJydiI6MCwicHIiOjExNSwic3QiOjAsInVyIjoiaHR0cDovL3N0YWNrb3ZlcmZsb3cuY29tL2Fib3V0L2NvbnRhY3QiLCJyZSI6MX0&s=hRods5B22XvRBwWIwtIMekcyNF8">advertising info</a>

                    <a onclick='StackExchange.switchMobile("on")'>mobile</a>
                    <b><a href="/contact">contact us</a></b>
                        <b><a href="http://meta.stackoverflow.com">feedback</a></b>
                    
                </div>
                <div id="footer-sites">
                    <table>
    <tr>
            <th colspan=3>
                Technology
            </th>
            <th >
                Life / Arts
            </th>
            <th >
                Culture / Recreation
            </th>
            <th >
                Science
            </th>
            <th >
                Other
            </th>
    </tr>
    <tr>
            <td>
                <ol>
                        <li><a href="http://stackoverflow.com" title="professional and enthusiast programmers">Stack Overflow</a></li>
                        <li><a href="http://serverfault.com" title="professional system and network administrators">Server Fault</a></li>
                        <li><a href="http://superuser.com" title="computer enthusiasts and power users">Super User</a></li>
                        <li><a href="http://webapps.stackexchange.com" title="power users of web applications">Web Applications</a></li>
                        <li><a href="http://askubuntu.com" title="Ubuntu users and developers">Ask Ubuntu</a></li>
                        <li><a href="http://webmasters.stackexchange.com" title="pro webmasters">Webmasters</a></li>
                        <li><a href="http://gamedev.stackexchange.com" title="professional and independent game developers">Game Development</a></li>
                        <li><a href="http://tex.stackexchange.com" title="users of TeX, LaTeX, ConTeXt, and related typesetting systems">TeX - LaTeX</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://programmers.stackexchange.com" title="professional programmers interested in conceptual questions about software development">Programmers</a></li>
                        <li><a href="http://unix.stackexchange.com" title="users of Linux, FreeBSD and other Un*x-like operating systems.">Unix &amp; Linux</a></li>
                        <li><a href="http://apple.stackexchange.com" title="power users of Apple hardware and software">Ask Different (Apple)</a></li>
                        <li><a href="http://wordpress.stackexchange.com" title="WordPress developers and administrators">WordPress Development</a></li>
                        <li><a href="http://gis.stackexchange.com" title="cartographers, geographers and GIS professionals">Geographic Information Systems</a></li>
                        <li><a href="http://electronics.stackexchange.com" title="electronics and electrical engineering professionals, students, and enthusiasts">Electrical Engineering</a></li>
                        <li><a href="http://android.stackexchange.com" title="enthusiasts and power users of the Android operating system">Android Enthusiasts</a></li>
                        <li><a href="http://security.stackexchange.com" title="Information security professionals">Information Security</a></li>
                            </ol></td><td><ol>
                        <li><a href="http://dba.stackexchange.com" title="database professionals who wish to improve their database skills and learn from others in the community">Database Administrators</a></li>
                        <li><a href="http://drupal.stackexchange.com" title="Drupal developers and administrators">Drupal Answers</a></li>
                        <li><a href="http://sharepoint.stackexchange.com" title="SharePoint enthusiasts">SharePoint</a></li>
                        <li><a href="http://ux.stackexchange.com" title="user experience researchers and experts">User Experience</a></li>
                        <li><a href="http://mathematica.stackexchange.com" title="users of Mathematica">Mathematica</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#technology" class="more">
                                more (14)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://photo.stackexchange.com" title="professional, enthusiast and amateur photographers">Photography</a></li>
                        <li><a href="http://scifi.stackexchange.com" title="science fiction and fantasy enthusiasts">Science Fiction &amp; Fantasy</a></li>
                        <li><a href="http://graphicdesign.stackexchange.com" title="professional graphic designers and non-designers trying to do their own graphic design">Graphic Design</a></li>
                        <li><a href="http://cooking.stackexchange.com" title="professional and amateur chefs">Seasoned Advice (cooking)</a></li>
                        <li><a href="http://diy.stackexchange.com" title="contractors and serious DIYers">Home Improvement</a></li>
                        <li><a href="http://money.stackexchange.com" title="people who want to be financially literate">Personal Finance &amp; Money</a></li>
                        <li><a href="http://academia.stackexchange.com" title="academics and those enrolled in higher education">Academia</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#lifearts" class="more">
                                more (10)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://english.stackexchange.com" title="linguists, etymologists, and serious English language enthusiasts">English Language &amp; Usage</a></li>
                        <li><a href="http://skeptics.stackexchange.com" title="scientific skepticism">Skeptics</a></li>
                        <li><a href="http://judaism.stackexchange.com" title="those who base their lives on Jewish law and tradition and anyone interested in learning more">Mi Yodeya (Judaism)</a></li>
                        <li><a href="http://travel.stackexchange.com" title="road warriors and seasoned travelers">Travel</a></li>
                        <li><a href="http://christianity.stackexchange.com" title="committed Christians, experts in Christianity and those interested in learning more">Christianity</a></li>
                        <li><a href="http://gaming.stackexchange.com" title="passionate videogamers on all platforms">Arqade (gaming)</a></li>
                        <li><a href="http://bicycles.stackexchange.com" title="people who build and repair bicycles, people who train cycling, or commute on bicycles">Bicycles</a></li>
                        <li><a href="http://rpg.stackexchange.com" title="gamemasters and players of tabletop, paper-and-pencil role-playing games">Role-playing Games</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#culturerecreation" class="more">
                                more (21)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://math.stackexchange.com" title="people studying math at any level and professionals in related fields">Mathematics</a></li>
                        <li><a href="http://stats.stackexchange.com" title="people interested in statistics, machine learning, data analysis, data mining, and data visualization">Cross Validated (stats)</a></li>
                        <li><a href="http://cstheory.stackexchange.com" title="theoretical computer scientists and researchers in related fields">Theoretical Computer Science</a></li>
                        <li><a href="http://physics.stackexchange.com" title="active researchers, academics and students of physics">Physics</a></li>
                        <li><a href="http://mathoverflow.net" title="professional mathematicians">MathOverflow</a></li>
                    
                        <li>
                            <a href="http://stackexchange.com/sites#science" class="more">
                                more (7)
                            </a>
                        </li>
                </ol>
            </td>
            <td>
                <ol>
                        <li><a href="http://stackapps.com" title="apps, scripts, and development with the Stack Exchange API">Stack Apps</a></li>
                        <li><a href="http://meta.stackexchange.com" title="meta-discussion of the Stack Exchange family of Q&amp;A websites">Meta Stack Exchange</a></li>
                        <li><a href="http://area51.stackexchange.com" title="proposing new sites in the Stack Exchange network">Area 51</a></li>
                        <li><a href="http://careers.stackoverflow.com">Stack Overflow Careers</a></li>
                    
                </ol>
            </td>
    </tr>
</table>
                </div>
            </div>

            <div id="copyright">
                site design / logo &#169; 2014 stack exchange inc; user contributions licensed under <a href="http://creativecommons.org/licenses/by-sa/3.0/" rel="license">cc by-sa 3.0</a> 
                with <a href="http://blog.stackoverflow.com/2009/06/attribution-required/" rel="license">attribution required</a>
            </div>
            <div id="svnrev">
                rev 2014.6.1.328
            </div>
            
        </div>
    </div>
    <noscript>
        <div id="noscript-warning">Stack Overflow works best with JavaScript enabled<img src="http://pixel.quantserve.com/pixel/p-c1rF4kxgLUzNc.gif" alt="" class="dno"></div>
    </noscript>
<script>var p = "http", d = "static"; if (document.location.protocol == "https:") { p += "s"; d = "engine"; } var z = document.createElement("script"); z.type = "text/javascript"; z.async = true; z.src = p + "://" + d + ".adzerk.net/ados.js"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(z, s);</script>
<script>
    var ados = ados || {};
    ados.run = ados.run || [];
    ados.run.push(function () { ados_setKeywords('c%2b%2b,h.264,rtp,libavcodec');; ados_load(); });         
</script>

    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () { (i[r].q = i[r].q || []).push(arguments) }, i[r].l = 1 * new Date(); a = s.createElement(o),
            m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m);
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-5620270-1');        
        
        ga('set', 'dimension2', '|c++|h.264|rtp|libavcodec|');         
        ga('send', 'pageview');
        var _qevents = _qevents || [],
            _comscore = _comscore || [];
        (function () {
            var ssl='https:'==document.location.protocol,
                s=document.getElementsByTagName('script')[0],
                qc=document.createElement('script');
            qc.async=true;
            qc.src=(ssl?'https://secure':'http://edge')+'.quantserve.com/quant.js';
            s.parentNode.insertBefore(qc, s);
            var sc=document.createElement('script');
            sc.async=true;
            sc.src=(ssl?'https://sb':'http://b') + '.scorecardresearch.com/beacon.js';
            s.parentNode.insertBefore(sc, s);
        })();
        _comscore.push({ c1: "2", c2: "17440561" });
        _qevents.push({ qacct: "p-c1rF4kxgLUzNc" });
    </script>        
    
    </body>
</html>